<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.31">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Emil Blaignan">
<meta name="dcterms.date" content="2025-04-03">

<title>A Coin Mixture Paradox: The Interesting Case of Constant Variance – Emil Blaignan</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script><script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js" type="module"></script>
<script src="../../site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-e1a5c8363afafaef2c763b6775fbf3ca.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap-e36ce5c26c48eccda62d8cde5e438854.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>

<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="../../styles.css">
</head>

<body class="nav-fixed quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top quarto-banner">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">Emil Blaignan</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../index.html"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../blog/index.html"> 
<span class="menu-text">Blog</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../projects.html"> 
<span class="menu-text">Projects</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../portfolio.html"> 
<span class="menu-text">Portfolio</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../cv.html"> 
<span class="menu-text">CV</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../personal.html"> 
<span class="menu-text">Personal</span></a>
  </li>  
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/emilblaignan"> <i class="bi bi-github" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://www.linkedin.com/in/emil-blaignan/"> <i class="bi bi-linkedin" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">A Coin Mixture Paradox: The Interesting Case of Constant Variance</h1>
                                <div class="quarto-categories">
                <div class="quarto-category">Bayesian Statistics</div>
                <div class="quarto-category">Probability</div>
              </div>
                  </div>
  </div>
    
  
  <div class="quarto-title-meta">

      <div>
      <div class="quarto-title-meta-heading">Author</div>
      <div class="quarto-title-meta-contents">
               <p>Emil Blaignan </p>
            </div>
    </div>
      
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">April 3, 2025</p>
      </div>
    </div>
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#introduction" id="toc-introduction" class="nav-link active" data-scroll-target="#introduction">Introduction</a></li>
  <li><a href="#coin-flip-variance-solution" id="toc-coin-flip-variance-solution" class="nav-link" data-scroll-target="#coin-flip-variance-solution">Coin Flip Variance Solution</a>
  <ul class="collapse">
  <li><a href="#step-1-compute-operatornamevarx_1" id="toc-step-1-compute-operatornamevarx_1" class="nav-link" data-scroll-target="#step-1-compute-operatornamevarx_1">Step 1: Compute <span class="math inline">\(\operatorname{Var}(X_1)\)</span></a></li>
  <li><a href="#step-2-compute-operatornamecovx_1-x_2" id="toc-step-2-compute-operatornamecovx_1-x_2" class="nav-link" data-scroll-target="#step-2-compute-operatornamecovx_1-x_2">Step 2: Compute <span class="math inline">\(\operatorname{Cov}(X_1, X_2)\)</span></a></li>
  <li><a href="#final-step-combine-all" id="toc-final-step-combine-all" class="nav-link" data-scroll-target="#final-step-combine-all">Final Step: Combine All</a></li>
  </ul></li>
  <li><a href="#interpretting-our-answer" id="toc-interpretting-our-answer" class="nav-link" data-scroll-target="#interpretting-our-answer">Interpretting Our Answer</a></li>
  <li><a href="#generalizing-the-problem" id="toc-generalizing-the-problem" class="nav-link" data-scroll-target="#generalizing-the-problem">Generalizing the Problem</a>
  <ul class="collapse">
  <li><a href="#explaining-the-constant-variance" id="toc-explaining-the-constant-variance" class="nav-link" data-scroll-target="#explaining-the-constant-variance">Explaining the Constant Variance</a></li>
  <li><a href="#step-1-conditional-expectations-and-variances" id="toc-step-1-conditional-expectations-and-variances" class="nav-link" data-scroll-target="#step-1-conditional-expectations-and-variances">Step 1: Conditional Expectations and Variances</a></li>
  <li><a href="#step-2-calculate-etextvary-c" id="toc-step-2-calculate-etextvary-c" class="nav-link" data-scroll-target="#step-2-calculate-etextvary-c">Step 2: Calculate <span class="math inline">\(E[\text{Var}(Y | C)]\)</span></a></li>
  <li><a href="#step-3-calculate-textvarey-c" id="toc-step-3-calculate-textvarey-c" class="nav-link" data-scroll-target="#step-3-calculate-textvarey-c">Step 3: Calculate <span class="math inline">\(\text{Var}(E[Y | C])\)</span></a></li>
  <li><a href="#step-4-combine-the-terms" id="toc-step-4-combine-the-terms" class="nav-link" data-scroll-target="#step-4-combine-the-terms">Step 4: Combine the Terms</a></li>
  <li><a href="#intuition-why-does-p-cancel-out" id="toc-intuition-why-does-p-cancel-out" class="nav-link" data-scroll-target="#intuition-why-does-p-cancel-out">Intuition: Why Does <span class="math inline">\(p\)</span> Cancel Out?</a></li>
  </ul></li>
  <li><a href="#conclusion" id="toc-conclusion" class="nav-link" data-scroll-target="#conclusion">Conclusion</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content">





<p><img src="coin_paradox_thumbnail.png" class="img-fluid"></p>
<section id="introduction" class="level2">
<h2 class="anchored" data-anchor-id="introduction">Introduction</h2>
<p>Recently, in my stochastic processes discussion, we went over a coin-flipping problem. In my probability course, we’ve covered many coin-toss problems, but I found this particular problem especially interesting—so much so that it sent me down a rabbit hole trying to understand it. The problem went as follows:</p>
<p><strong>Imagine you have two coins. One is perfectly fair (50% chance of heads), and the other is biased, with a 60% chance of heads. Visually, the coins are indistinguishable. We then flip the left coin twice (not knowing if it is fair or biased), thus what is the variance of the number of heads denoted by <span class="math inline">\(\text{Var}(\text{\# heads})\)</span>?</strong></p>
</section>
<section id="coin-flip-variance-solution" class="level2">
<h2 class="anchored" data-anchor-id="coin-flip-variance-solution">Coin Flip Variance Solution</h2>
<p>The solution goes as follows:</p>
<p>Let<br>
<span class="math display">\[
X = X_1 + X_2
\]</span><br>
where <span class="math inline">\(X_1\)</span> and <span class="math inline">\(X_2\)</span> represent the results of the first and second coin flips, respectively (1 = heads, 0 = tails).</p>
<p>We want to compute: <span class="math display">\[
\operatorname{Var}(X) = \operatorname{Var}(X_1 + X_2)
\]</span></p>
<p>Using the identity: <span class="math display">\[
\operatorname{Var}(X_1 + X_2) = \operatorname{Var}(X_1) + \operatorname{Var}(X_2) + 2 \cdot \operatorname{Cov}(X_1, X_2)
\]</span></p>
<blockquote class="blockquote">
<p><em>Note: The two coin flips are <strong>not independent</strong>, since flipping one head increases the likelihood that the coin is biased. Hence, we must account for covariance.</em></p>
</blockquote>
<hr>
<section id="step-1-compute-operatornamevarx_1" class="level3">
<h3 class="anchored" data-anchor-id="step-1-compute-operatornamevarx_1">Step 1: Compute <span class="math inline">\(\operatorname{Var}(X_1)\)</span></h3>
<p><span class="math display">\[
\operatorname{Var}(X_1) = \mathbb{E}[X_1^2] - (\mathbb{E}[X_1])^2
\]</span></p>
<p>Since <span class="math inline">\(X_1 \in \{0, 1\}\)</span> (Bernoulli random variable), <span class="math inline">\(X_1^2 = X_1\)</span>, so: <span class="math display">\[
\mathbb{E}[X_1^2] = \mathbb{E}[X_1]
\]</span></p>
<p>We compute <span class="math inline">\(\mathbb{E}[X_1]\)</span> using the law of total expectation: <span class="math display">\[
\mathbb{E}[X_1] = \mathbb{P}(\text{Heads}) = \frac{1}{2}(0.5) + \frac{1}{2}(0.6) = 0.55
\]</span></p>
<p><span class="math display">\[
\operatorname{Var}(X_1) = 0.55 - (0.55)^2 = 0.55 - 0.3025 = 0.2475
\]</span></p>
<p>By symmetry: <span class="math display">\[
\operatorname{Var}(X_2) = \operatorname{Var}(X_1) = 0.2475
\]</span></p>
<hr>
</section>
<section id="step-2-compute-operatornamecovx_1-x_2" class="level3">
<h3 class="anchored" data-anchor-id="step-2-compute-operatornamecovx_1-x_2">Step 2: Compute <span class="math inline">\(\operatorname{Cov}(X_1, X_2)\)</span></h3>
<p>We use: <span class="math display">\[
\operatorname{Cov}(X_1, X_2) = \mathbb{E}[X_1 X_2] - \mathbb{E}[X_1]\mathbb{E}[X_2]
\]</span></p>
<section id="compute-mathbbex_1-x_2" class="level4">
<h4 class="anchored" data-anchor-id="compute-mathbbex_1-x_2">Compute <span class="math inline">\(\mathbb{E}[X_1 X_2]\)</span></h4>
<p>This is the probability that both flips are heads: <span class="math display">\[
\mathbb{P}(\text{both H}) = \mathbb{P}(\text{both H} \mid \text{fair}) \cdot \mathbb{P}(\text{fair}) + \mathbb{P}(\text{both H} \mid \text{biased}) \cdot \mathbb{P}(\text{biased})
\]</span></p>
<p><span class="math display">\[
= (0.5)(0.5)^2 + (0.5)(0.6)^2 = 0.5(0.25) + 0.5(0.36) = 0.125 + 0.18 = 0.305
\]</span></p>
</section>
<section id="compute-mathbbex_1mathbbex_2" class="level4">
<h4 class="anchored" data-anchor-id="compute-mathbbex_1mathbbex_2">Compute <span class="math inline">\(\mathbb{E}[X_1]\mathbb{E}[X_2]\)</span></h4>
<p><span class="math display">\[
= (0.55)^2 = 0.3025
\]</span></p>
<p>So, <span class="math display">\[
\operatorname{Cov}(X_1, X_2) = 0.305 - 0.3025 = 0.0025
\]</span></p>
<hr>
</section>
</section>
<section id="final-step-combine-all" class="level3">
<h3 class="anchored" data-anchor-id="final-step-combine-all">Final Step: Combine All</h3>
<p><span class="math display">\[
\operatorname{Var}(X) = \operatorname{Var}(X_1) + \operatorname{Var}(X_2) + 2 \cdot \operatorname{Cov}(X_1, X_2)
\]</span></p>
<p><span class="math display">\[
= 0.2475 + 0.2475 + 2(0.0025) = 0.495 + 0.005 = \boxed{0.5}
\]</span></p>
</section>
</section>
<section id="interpretting-our-answer" class="level2">
<h2 class="anchored" data-anchor-id="interpretting-our-answer">Interpretting Our Answer</h2>
<p>I don’t know about you, but I found it hard to believe that the answer was actually 1/2.</p>
<p>For example, we know:</p>
<ul>
<li>A fair coin (p=0.5) flipped twice has variance 0.5</li>
<li>A biased coin (p=0.6) flipped twice has variance 0.48</li>
<li>We have a 50/50 chance of using either coin</li>
</ul>
<p>We can also graph the relationship of variance to probability of heads:</p>
<div id="4e1125e1-1d16-43ad-9e41-d5f2a2e61fb8" class="cell" data-tags="[]" data-execution_count="9">
<div class="cell-output cell-output-display">
<iframe scrolling="no" width="820px" height="520" src="iframe_figures/figure_9.html" frameborder="0" allowfullscreen=""></iframe>
</div>
</div>
<p>So, kind of like a magic trick, how is it possible that with a biased coin, our variance is the same as if we flipped two fair coins?</p>
<p>The answer is actually in the wording of the problem. By adding the uncertainty about which coin we’re using (we picked the left coin not knowing whether it’s fair or biased), we perfectly compensate for the reduced variance of the biased coin. On top of that, it wouldn’t matter whether the probability of heads was 0.6 or 0.7 or 0.8. For any probability of heads for the biased coin, our variance of heads for the two coin flips will always be 0.5.</p>
<p>It was at this point that I left the discussion knowing the answer to the paradox, however, I still wasn’t fully convinced. Thus, as any curious mathematician would do, I sought to understand why our solution works the way it does by generalizing the problem.</p>
</section>
<section id="generalizing-the-problem" class="level2">
<h2 class="anchored" data-anchor-id="generalizing-the-problem">Generalizing the Problem</h2>
<p><strong>Imagine you have two coins. One is perfectly fair (50% chance of heads), and the other is biased, but you don’t necessarily know its exact bias – just that it has some probability <em>p</em> of landing heads.</strong></p>
<p>Now, consider this experiment:</p>
<ol type="1">
<li>You randomly pick one of the two coins (with equal probability, 0.5 each).</li>
<li>You flip the <em>chosen</em> coin twice.</li>
<li>You count the total number of heads, let’s call this <em>Y</em>.</li>
</ol>
<p>Let’s define our variables more formally:</p>
<ul>
<li><span class="math inline">\(C\)</span>: The random variable representing the chosen coin.
<ul>
<li><span class="math inline">\(C = F\)</span> (Fair coin) with <span class="math inline">\(P(C=F) = 0.5\)</span></li>
<li><span class="math inline">\(C = B\)</span> (Biased coin) with <span class="math inline">\(P(C=B) = 0.5\)</span></li>
</ul></li>
<li>Probabilities of Heads:
<ul>
<li><span class="math inline">\(P(\text{Heads} | C=F) = p_F = 0.5\)</span></li>
<li><span class="math inline">\(P(\text{Heads} | C=B) = p_B = p\)</span> (where <span class="math inline">\(0 \leq p \leq 1\)</span>)</li>
</ul></li>
<li><strong><span class="math inline">\(X_1, X_2\)</span></strong>: The outcomes of the two flips (1 for heads, 0 for tails). These are Bernoulli trials <em>given</em> the chosen coin.</li>
<li><strong><span class="math inline">\(Y\)</span></strong>: The total number of heads in the two flips. <span class="math inline">\(Y = X_1 + X_2\)</span>. <em>Given</em> the coin, <span class="math inline">\(Y\)</span> follows a Binomial distribution <span class="math inline">\(\text{Bin}(n=2, \text{probability}=p_C)\)</span>.</li>
</ul>
<p>Our goal is to calculate <span class="math inline">\(\text{Var}(Y)\)</span>, the variance of the total number of heads <em>before</em> we know which coin was chosen.</p>
<section id="explaining-the-constant-variance" class="level3">
<h3 class="anchored" data-anchor-id="explaining-the-constant-variance">Explaining the Constant Variance</h3>
<p>The key to understanding this result lies in the <strong>Law of Total Variance</strong> (also known as Eve’s Law). For random variables <span class="math inline">\(Y\)</span> and <span class="math inline">\(C\)</span>, it states:</p>
<p><span class="math display">\[\text{Var}(Y) = E[\text{Var}(Y | C)] + \text{Var}(E[Y | C])\]</span></p>
<p>Let’s break this down:</p>
<ol type="1">
<li><p><strong><span class="math inline">\(E[\text{Var}(Y | C)]\)</span></strong>: The <em>expected value of the conditional variance</em>. This is the average variance <em>within</em> each coin type. We calculate the variance of <span class="math inline">\(Y\)</span> <em>assuming</em> we know which coin was picked (<span class="math inline">\(\text{Var}(Y | C=F)\)</span> and <span class="math inline">\(\text{Var}(Y | C=B)\)</span>) and then find the weighted average of these variances based on the probability of picking each coin.</p></li>
<li><p><strong><span class="math inline">\(\text{Var}(E[Y | C])\)</span></strong>: The <em>variance of the conditional expectation</em>. This measures the variability <em>between</em> the average outcomes of the different coin types. We calculate the expected value of <span class="math inline">\(Y\)</span> <em>assuming</em> we know which coin was picked (<span class="math inline">\(E[Y | C=F]\)</span> and <span class="math inline">\(E[Y | C=B]\)</span>) and then find the variance of these expected values, treating <span class="math inline">\(E[Y | C]\)</span> itself as a random variable that depends on <span class="math inline">\(C\)</span>.</p></li>
</ol>
<p>Let’s calculate each term.</p>
</section>
<section id="step-1-conditional-expectations-and-variances" class="level3">
<h3 class="anchored" data-anchor-id="step-1-conditional-expectations-and-variances">Step 1: Conditional Expectations and Variances</h3>
<p>First, let’s find the expected value and variance of <span class="math inline">\(Y\)</span>, <em>conditional</em> on knowing which coin was chosen.</p>
<ul>
<li><strong>Given the Fair Coin (<span class="math inline">\(C=F\)</span>):</strong>
<ul>
<li>The number of heads <span class="math inline">\(Y\)</span> follows <span class="math inline">\(\text{Bin}(n=2, p=0.5)\)</span>.</li>
<li><span class="math inline">\(E[Y | C=F] = n \cdot p_F = 2 \times 0.5 = 1\)</span></li>
<li><span class="math inline">\(\text{Var}(Y | C=F) = n \cdot p_F \cdot (1 - p_F) = 2 \cdot 0.5 \cdot (1 - 0.5) = 2 \cdot 0.5 \times 0.5 = 0.5\)</span></li>
</ul></li>
<li><strong>Given the Biased Coin (<span class="math inline">\(C=B\)</span>):</strong>
<ul>
<li>The number of heads <span class="math inline">\(Y\)</span> follows <span class="math inline">\(\text{Bin}(n=2, p=p)\)</span>.</li>
<li><span class="math inline">\(E[Y | C=B] = n \cdot p_B = 2 \times p\)</span></li>
<li><span class="math inline">\(\text{Var}(Y | C=B) = n \cdot p_B \cdot (1 - p_B) = 2 \cdot p \times (1 - p) = 2p(1-p)\)</span></li>
</ul></li>
</ul>
</section>
<section id="step-2-calculate-etextvary-c" class="level3">
<h3 class="anchored" data-anchor-id="step-2-calculate-etextvary-c">Step 2: Calculate <span class="math inline">\(E[\text{Var}(Y | C)]\)</span></h3>
<p>This is the average of the conditional variances, weighted by the probability of choosing each coin:</p>
<p><span class="math display">\[E[\text{Var}(Y | C)] = \text{Var}(Y | C=F) \cdot P(C=F) + \text{Var}(Y | C=B) \cdot P(C=B)\]</span></p>
<p><span class="math display">\[E[\text{Var}(Y | C)] = (0.5) \cdot (0.5) + (2p(1-p)) \cdot (0.5)\]</span></p>
<p><span class="math display">\[E[\text{Var}(Y | C)] = 0.25 + p(1-p)\]</span></p>
<p><span class="math display">\[E[\text{Var}(Y | C)] = 0.25 + p - p^2\]</span></p>
</section>
<section id="step-3-calculate-textvarey-c" class="level3">
<h3 class="anchored" data-anchor-id="step-3-calculate-textvarey-c">Step 3: Calculate <span class="math inline">\(\text{Var}(E[Y | C])\)</span></h3>
<p>This is the variance of the conditional means. We have a random variable <span class="math inline">\(E[Y | C]\)</span> which takes the value <span class="math inline">\(E[Y | C=F] = 1\)</span> with probability 0.5, and the value <span class="math inline">\(E[Y | C=B] = 2p\)</span> with probability 0.5.</p>
<p>To find its variance, we use <span class="math inline">\(\text{Var}(X) = E[X^2] - (E[X])^2\)</span>.</p>
<ul>
<li><p>First, find the mean <span class="math inline">\(E[E[Y | C]]\)</span>:</p>
<p><span class="math display">\[E[E[Y | C]] = E[Y | C=F] \cdot P(C=F) + E[Y | C=B] \cdot P(C=B)\]</span></p>
<p><span class="math display">\[E[E[Y | C]] = (1) \cdot (0.5) + (2p) \cdot (0.5)\]</span></p>
<p><span class="math display">\[E[E[Y | C]] = 0.5 + p\]</span></p>
<p><em>(Note: By the law of total expectation, this is also <span class="math inline">\(E[Y]\)</span>).</em></p></li>
<li><p>Next, find the expected value of the square <span class="math inline">\(E[(E[Y | C])^2]\)</span>:</p>
<p><span class="math display">\[E[(E[Y | C])^2] = (E[Y | C=F])^2 \cdot P(C=F) + (E[Y | C=B])^2 \cdot P(C=B)\]</span></p>
<p><span class="math display">\[E[(E[Y | C])^2] = (1)^2 \cdot (0.5) + (2p)^2 \cdot (0.5)\]</span></p>
<p><span class="math display">\[E[(E[Y | C])^2] = 1 \cdot 0.5 + 4p^2 \cdot 0.5\]</span></p>
<p><span class="math display">\[E[(E[Y | C])^2] = 0.5 + 2p^2\]</span></p></li>
<li><p>Now, calculate the variance:</p>
<p><span class="math display">\[\text{Var}(E[Y | C]) = E[(E[Y | C])^2] - (E[E[Y | C]])^2\]</span></p>
<p><span class="math display">\[\text{Var}(E[Y | C]) = (0.5 + 2p^2) - (0.5 + p)^2\]</span></p>
<p><span class="math display">\[\text{Var}(E[Y | C]) = 0.5 + 2p^2 - (0.25 + p + p^2)\]</span></p>
<p><span class="math display">\[\text{Var}(E[Y | C]) = 0.5 + 2p^2 - 0.25 - p - p^2\]</span></p>
<p><span class="math display">\[\text{Var}(E[Y | C]) = 0.25 - p + p^2\]</span></p></li>
</ul>
</section>
<section id="step-4-combine-the-terms" class="level3">
<h3 class="anchored" data-anchor-id="step-4-combine-the-terms">Step 4: Combine the Terms</h3>
<p>Now we add the two components according to the Law of Total Variance:</p>
<p><span class="math display">\[\text{Var}(Y) = E[\text{Var}(Y | C)] + \text{Var}(E[Y | C])\]</span></p>
<p><span class="math display">\[\text{Var}(Y) = (0.25 + p - p^2) + (0.25 - p + p^2)\]</span></p>
<p>Notice how the terms involving <span class="math inline">\(p\)</span> and <span class="math inline">\(p^2\)</span> cancel out!</p>
<p><span class="math display">\[\text{Var}(Y) = 0.25 + 0.25 + (p - p) + (-p^2 + p^2)\]</span></p>
<p><span class="math display">\[\text{Var}(Y) = 0.5\]</span></p>
<p>The variance <span class="math inline">\(\text{Var}(Y)\)</span> is indeed <span class="math inline">\(0.5\)</span>, regardless of the value of <span class="math inline">\(p\)</span>.</p>
</section>
<section id="intuition-why-does-p-cancel-out" class="level3">
<h3 class="anchored" data-anchor-id="intuition-why-does-p-cancel-out">Intuition: Why Does <span class="math inline">\(p\)</span> Cancel Out?</h3>
<p>The cancellation happens because the two components of the total variance move in opposite directions as the bias <span class="math inline">\(p\)</span> changes:</p>
<ul>
<li><p><strong>Average Within-Coin Variance (<span class="math inline">\(E[\text{Var}(Y | C)] = 0.25 + p(1-p)\)</span>):</strong> This term represents the inherent randomness <em>within</em> each coin type. The variance of a single Bernoulli or Binomial trial is maximized when <span class="math inline">\(p=0.5\)</span>. So, as the biased coin’s <span class="math inline">\(p\)</span> moves away from 0.5 (towards 0 or 1), its individual variance <span class="math inline">\(2p(1-p)\)</span> <em>decreases</em>. This makes the <em>average</em> variance term smaller when <span class="math inline">\(p\)</span> is far from 0.5.</p></li>
<li><p><strong>Variance Between Coin Averages (<span class="math inline">\(\text{Var}(E[Y | C]) = 0.25 - p + p^2\)</span>):</strong> This term represents how different the <em>average</em> outcomes are for the two coins. The expected values are <span class="math inline">\(E[Y|C=F]=1\)</span> and <span class="math inline">\(E[Y|C=B]=2p\)</span>. When <span class="math inline">\(p=0.5\)</span>, both expectations are 1, so there’s <em>no variance</em> between them (<span class="math inline">\(\text{Var}(E[Y|C]) = 0.25 - 0.5 + 0.25 = 0\)</span>). As <span class="math inline">\(p\)</span> moves away from 0.5, the difference between the average outcomes (1 and 2p) <em>increases</em>, leading to a <em>larger</em> variance between the conditional expectations.</p></li>
</ul>
<p>These two effects perfectly offset each other. As the bias <span class="math inline">\(p\)</span> makes one term smaller, it makes the other term larger by exactly the same amount, keeping their sum constant at 0.5.</p>
<div id="338afeb8-9ef0-4e79-bac8-2bebafbe3526" class="cell" data-tags="[]" data-execution_count="15">
<div class="cell-output cell-output-display">
<iframe scrolling="no" width="820px" height="520" src="iframe_figures/figure_15.html" frameborder="0" allowfullscreen=""></iframe>
</div>
</div>
</section>
</section>
<section id="conclusion" class="level2">
<h2 class="anchored" data-anchor-id="conclusion">Conclusion</h2>
<p>The constant variance of 0.5 in this coin mixture problem is a fascinating result that stems directly from the Law of Total Variance. While it seems paradoxical that the overall variability doesn’t depend on the specific bias <span class="math inline">\(p\)</span> of the second coin, the mathematical breakdown shows a perfect cancellation effect. The average variance <em>within</em> the coin types and the variance <em>between</em> the coin types’ average outcomes compensate for each other precisely.</p>
<p>This example highlights how decomposing variance can reveal underlying structures and sometimes lead to surprising, constant results even when parameters within the mixture model are changing. It also serves as a reminder that our intuition about how probability distributions combine can sometimes be misleading!</p>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->




</body></html>