<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.31">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Emil Blaignan">
<meta name="dcterms.date" content="2025-03-20">

<title>YieldCurveForecaster: 3D Yield Curve Modeling and Forecasting Dashboard – Emil Blaignan</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js" type="module"></script>
<script src="../../site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-e1a5c8363afafaef2c763b6775fbf3ca.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap-dde8d7229bfee0f8bb5efd37f0f9ae1e.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="../../styles.css">
</head>

<body class="nav-fixed quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top quarto-banner">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">Emil Blaignan</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../index.html"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../blog/index.html"> 
<span class="menu-text">Blog</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../projects.html"> 
<span class="menu-text">Projects</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../portfolio.html"> 
<span class="menu-text">Portfolio</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../cv.html"> 
<span class="menu-text">CV</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../personal.html"> 
<span class="menu-text">Personal</span></a>
  </li>  
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/emilblaignan"> <i class="bi bi-github" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://www.linkedin.com/in/emil-blaignan/"> <i class="bi bi-linkedin" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">YieldCurveForecaster: 3D Yield Curve Modeling and Forecasting Dashboard</h1>
                                <div class="quarto-categories">
                <div class="quarto-category">Week 11</div>
              </div>
                  </div>
  </div>
    
  
  <div class="quarto-title-meta">

      <div>
      <div class="quarto-title-meta-heading">Author</div>
      <div class="quarto-title-meta-contents">
               <p>Emil Blaignan </p>
            </div>
    </div>
      
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">March 20, 2025</p>
      </div>
    </div>
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#introduction" id="toc-introduction" class="nav-link active" data-scroll-target="#introduction">Introduction</a></li>
  <li><a href="#project-overview" id="toc-project-overview" class="nav-link" data-scroll-target="#project-overview">Project Overview</a></li>
  <li><a href="#technical-components" id="toc-technical-components" class="nav-link" data-scroll-target="#technical-components">Technical Components</a>
  <ul class="collapse">
  <li><a href="#creating-and-interacting-with-a-sql-database" id="toc-creating-and-interacting-with-a-sql-database" class="nav-link" data-scroll-target="#creating-and-interacting-with-a-sql-database">Creating and Interacting with a SQL Database</a></li>
  <li><a href="#complex-data-visualization-via-plotly" id="toc-complex-data-visualization-via-plotly" class="nav-link" data-scroll-target="#complex-data-visualization-via-plotly">Complex Data Visualization via Plotly</a></li>
  <li><a href="#mathematical-modeling" id="toc-mathematical-modeling" class="nav-link" data-scroll-target="#mathematical-modeling">Mathematical Modeling</a></li>
  <li><a href="#building-a-dynamic-dash-app" id="toc-building-a-dynamic-dash-app" class="nav-link" data-scroll-target="#building-a-dynamic-dash-app">Building a Dynamic Dash App</a></li>
  </ul></li>
  <li><a href="#conclusion-and-ethical-considerations" id="toc-conclusion-and-ethical-considerations" class="nav-link" data-scroll-target="#conclusion-and-ethical-considerations">Conclusion and Ethical Considerations</a>
  <ul class="collapse">
  <li><a href="#ethics" id="toc-ethics" class="nav-link" data-scroll-target="#ethics">Ethics</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content">





<p><img src="3DYieldCurve.png" class="img-fluid"></p>
<section id="introduction" class="level2">
<h2 class="anchored" data-anchor-id="introduction">Introduction</h2>
<p>A yield curve is a graph that shows the interest rates (yields) of bonds with different maturity dates. It typically represents U.S. Treasury bonds and helps indicate the overall health of the economy.</p>
<ul>
<li>Short-term bonds (e.g., 3 months) usually have lower yields.</li>
<li>Long-term bonds (e.g., 30 years) usually have higher yields (risk premium)</li>
</ul>
<p>Shapes tell economic stories:</p>
<ul>
<li>Normal (upward): Healthy economy</li>
<li>Flat: Economic transition</li>
<li>Inverted: Recession signal</li>
</ul>
<p>This project aims to model the yield curve in three-dimensions, as well as forecast yields using exogenous variables to formulate “regime-awareness” for classic forecasting models (i.e.&nbsp;Nelson-Siegel Models).</p>
<p><a href="https://github.com/emilblaignan/YieldCurveForecaster">GitHub Repository Link</a></p>
</section>
<section id="project-overview" class="level2">
<h2 class="anchored" data-anchor-id="project-overview">Project Overview</h2>
<p>The project is split up into three main categories:</p>
<ol type="1">
<li><strong>Data Management</strong>: The acquisition of data from FRED API (Yield data, CPI, VIX), SQLite database formation, and SQL query functions.</li>
<li><strong>Forecasting Models (Mathematical Modeling)</strong>: The forecasting models (dynamic exponential decay, AFNS, etc.).</li>
<li><strong>Backtesting &amp; Analysis</strong>: The functions used to backtest each model and calculate the error metrics/statistics.</li>
</ol>
<p>There are other important modules such as the plotting module and dash app module, but for the sake of the entirety of the project, the forecasting module was the main focus of work and research.</p>
<p><img src="YieldCurveProject.png" class="img-fluid"></p>
<p>At the project’s foundation, lies an SQLite database that stores historical yield curve data, inflation metrics, and market volatility indices. The data layer (<code>data.py</code>) handles all the database operations using parameterized queries and includes ETL (Extract, Transform, Load) functionality. This ensures that time-based and maturity-related data is cleaned up and standardized, making it ready for use down the line. The mathematical modeling layer (<code>models.py</code> and <code>utils.py</code>) implements the Nelson-Siegel framework and “regime-awareness” forecasting algorithms, containing the complex mathematics of yield curve dynamics. The analytics layer (<code>analysis.py</code>) provides backtesting capabilities and statistical analysis functions that operate on both historical and forecasted data.</p>
<p>The project’s visualizations and user interactions are built on Dash, implementing a reactive programming model where UI components respond to user inputs through callback functions. This setup ensures a smooth and connected workflow, where any changes you make to the parameters in the interface automatically flow through the entire system. It triggers the necessary database queries, runs the right modeling functions, and updates the visualizations seamlessly—all in real time. The application’s state management system ensures that computational resources are used efficiently, with heavy operations like backtesting performed only when explicitly requested.</p>
</section>
<section id="technical-components" class="level2">
<h2 class="anchored" data-anchor-id="technical-components">Technical Components</h2>
<p>The main technical components include:</p>
<ol type="1">
<li>Creating and Interacting with a SQL Database</li>
<li>Complex Data Visualization via Plotly</li>
<li>Mathematical Modeling</li>
<li>Building a Dynamic Dash App</li>
</ol>
<section id="creating-and-interacting-with-a-sql-database" class="level3">
<h3 class="anchored" data-anchor-id="creating-and-interacting-with-a-sql-database">Creating and Interacting with a SQL Database</h3>
<p>This project sets up a data storage system using an SQLite database, complete with custom query functions designed to pull time-based financial data efficiently. Unlike simpler methods like relying on CSV files, this database is structured to fetch only the exact data required for specific analyses. This approach minimizes memory usage, especially when working with large datasets that cover several decades.</p>
<p>The database is organized into separate tables for yield curve data, market volatility metrics, and inflation, all using consistent date formats to ensure everything lines up correctly over time. To keep things secure and flexible, the data access layer uses parameterized queries, which guard against SQL injection risks while offering versatile ways to retrieve the data you need.</p>
<p>The first step in the project was to fetch the data from FRED API. The <code>update_db.py</code> module contains multiple functions to fetch data but we’ll focus on fetching the yield data:</p>
<div id="6663edc0-235d-4213-90d7-6fb14d89b694" class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> fetch_treasury_yields(start_date, end_date):</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="co">    Fetch Treasury yield data from FRED for various maturities.</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="co">    </span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="co">    Returns:</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="co">        DataFrame with date index and columns for different maturities.</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="co">    """</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>    logger.info(<span class="ss">f"Fetching Treasury yields from </span><span class="sc">{</span>start_date<span class="sc">}</span><span class="ss"> to </span><span class="sc">{</span>end_date<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>    <span class="co"># FRED series IDs for different Treasury maturities</span></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Format: (maturity_label, series_id)</span></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>    treasury_series <span class="op">=</span> [</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>        (<span class="st">'T1M'</span>, <span class="st">'DGS1MO'</span>),   <span class="co"># 1-Month Treasury Constant Maturity Rate</span></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>        (<span class="st">'T3M'</span>, <span class="st">'DGS3MO'</span>),   <span class="co"># 3-Month Treasury Constant Maturity Rate</span></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>        (<span class="st">'T6M'</span>, <span class="st">'DGS6MO'</span>),   <span class="co"># 6-Month Treasury Constant Maturity Rate</span></span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a>        (<span class="st">'T1'</span>, <span class="st">'DGS1'</span>),      <span class="co"># 1-Year Treasury Constant Maturity Rate</span></span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a>        (<span class="st">'T2'</span>, <span class="st">'DGS2'</span>),      <span class="co"># 2-Year Treasury Constant Maturity Rate</span></span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a>        (<span class="st">'T5'</span>, <span class="st">'DGS5'</span>),      <span class="co"># 5-Year Treasury Constant Maturity Rate</span></span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a>        (<span class="st">'T10'</span>, <span class="st">'DGS10'</span>),    <span class="co"># 10-Year Treasury Constant Maturity Rate</span></span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a>        (<span class="st">'T30'</span>, <span class="st">'DGS30'</span>)     <span class="co"># 30-Year Treasury Constant Maturity Rate</span></span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a>    ]</span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Initialize dictionary to store series data</span></span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a>    yields_data <span class="op">=</span> {}</span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Fetch each series</span></span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> label, series_id <span class="kw">in</span> treasury_series:</span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a>        <span class="cf">try</span>:</span>
<span id="cb1-29"><a href="#cb1-29" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Get data from FRED API</span></span>
<span id="cb1-30"><a href="#cb1-30" aria-hidden="true" tabindex="-1"></a>            series <span class="op">=</span> fred.get_series(series_id, start_date, end_date)</span>
<span id="cb1-31"><a href="#cb1-31" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="kw">not</span> series.empty:</span>
<span id="cb1-32"><a href="#cb1-32" aria-hidden="true" tabindex="-1"></a>                yields_data[label] <span class="op">=</span> series</span>
<span id="cb1-33"><a href="#cb1-33" aria-hidden="true" tabindex="-1"></a>                logger.info(<span class="ss">f"Successfully fetched </span><span class="sc">{</span>label<span class="sc">}</span><span class="ss"> yields (</span><span class="sc">{</span><span class="bu">len</span>(series)<span class="sc">}</span><span class="ss"> observations)"</span>)</span>
<span id="cb1-34"><a href="#cb1-34" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span>:</span>
<span id="cb1-35"><a href="#cb1-35" aria-hidden="true" tabindex="-1"></a>                logger.warning(<span class="ss">f"No data returned for </span><span class="sc">{</span>label<span class="sc">}</span><span class="ss"> (series ID: </span><span class="sc">{</span>series_id<span class="sc">}</span><span class="ss">)"</span>)</span>
<span id="cb1-36"><a href="#cb1-36" aria-hidden="true" tabindex="-1"></a>        <span class="cf">except</span> <span class="pp">Exception</span> <span class="im">as</span> e:</span>
<span id="cb1-37"><a href="#cb1-37" aria-hidden="true" tabindex="-1"></a>            logger.error(<span class="ss">f"Error fetching </span><span class="sc">{</span>label<span class="sc">}</span><span class="ss"> (series ID: </span><span class="sc">{</span>series_id<span class="sc">}</span><span class="ss">): </span><span class="sc">{</span><span class="bu">str</span>(e)<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb1-38"><a href="#cb1-38" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb1-39"><a href="#cb1-39" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Convert to DataFrame</span></span>
<span id="cb1-40"><a href="#cb1-40" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> yields_data:</span>
<span id="cb1-41"><a href="#cb1-41" aria-hidden="true" tabindex="-1"></a>        df <span class="op">=</span> pd.DataFrame(yields_data)</span>
<span id="cb1-42"><a href="#cb1-42" aria-hidden="true" tabindex="-1"></a>        df.index.name <span class="op">=</span> <span class="st">'date'</span></span>
<span id="cb1-43"><a href="#cb1-43" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb1-44"><a href="#cb1-44" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Convert index to datetime if not already</span></span>
<span id="cb1-45"><a href="#cb1-45" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="kw">not</span> <span class="bu">isinstance</span>(df.index, pd.DatetimeIndex):</span>
<span id="cb1-46"><a href="#cb1-46" aria-hidden="true" tabindex="-1"></a>            df.index <span class="op">=</span> pd.to_datetime(df.index)</span>
<span id="cb1-47"><a href="#cb1-47" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb1-48"><a href="#cb1-48" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> df</span>
<span id="cb1-49"><a href="#cb1-49" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb1-50"><a href="#cb1-50" aria-hidden="true" tabindex="-1"></a>        logger.error(<span class="st">"Failed to fetch any Treasury yield data"</span>)</span>
<span id="cb1-51"><a href="#cb1-51" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> pd.DataFrame()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The main challenge stemmed from dealing with multiple yield maturities fetched from the FRED API. Since variable names can’t start with an integer, I had to rename each maturity by adding a “T” at the beginning. This adjustment later necessitated a custom function to convert these specially named maturity variables back into numerical values for analysis. Additionally, the data had to be concatenated and reshaped (using a “melt” operation) to ensure it was properly structured for the <code>data.py</code> module to query and process efficiently.</p>
<p>The <code>data.py</code> module houses all the query functions, some of which require more than just querying between two dates. An example of this is the <code>get_historical_inflation()</code> function, which not only retrieves CPI data but also computes year-over-year inflation rates directly in the query:</p>
<div id="934325a1-2b87-4173-a38d-d303bbbd010a" class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> get_historical_inflation(db_file: <span class="bu">str</span>, start_date: <span class="bu">str</span>, end_date: <span class="bu">str</span>) <span class="op">-&gt;</span> pd.DataFrame:</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="co">    Fetch historical inflation data and compute Year-over-Year (YoY) CPI change.</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="co">    Args:</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a><span class="co">        db_file (str): Path to SQLite database.</span></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a><span class="co">        start_date (str): Start date in 'YYYY-MM-DD' format.</span></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a><span class="co">        end_date (str): End date in 'YYYY-MM-DD' format.</span></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a><span class="co">    Returns:</span></span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a><span class="co">        pd.DataFrame: DataFrame with ['date', 'CPI', 'inflation_rate'].</span></span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a><span class="co">    """</span></span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>    query <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a><span class="st">        SELECT date, CPI</span></span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a><span class="st">        FROM Inflation</span></span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a><span class="st">        WHERE date BETWEEN ? AND ?</span></span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a><span class="st">        ORDER BY date ASC</span></span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a><span class="st">    """</span></span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a>    <span class="cf">try</span>:</span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a>        <span class="cf">with</span> sqlite3.<span class="ex">connect</span>(db_file) <span class="im">as</span> conn:</span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a>            df <span class="op">=</span> pd.read_sql_query(query, conn, params<span class="op">=</span>(start_date, end_date))</span>
<span id="cb2-22"><a href="#cb2-22" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb2-23"><a href="#cb2-23" aria-hidden="true" tabindex="-1"></a>        df <span class="op">=</span> df.sort_values(<span class="st">"date"</span>)</span>
<span id="cb2-24"><a href="#cb2-24" aria-hidden="true" tabindex="-1"></a>        df[<span class="st">"inflation_rate"</span>] <span class="op">=</span> df[<span class="st">"CPI"</span>].pct_change(<span class="dv">12</span>) <span class="op">*</span> <span class="dv">100</span>  <span class="co"># Compute YoY inflation rate</span></span>
<span id="cb2-25"><a href="#cb2-25" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb2-26"><a href="#cb2-26" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> df.dropna()</span>
<span id="cb2-27"><a href="#cb2-27" aria-hidden="true" tabindex="-1"></a>    <span class="cf">except</span> <span class="pp">Exception</span> <span class="im">as</span> e:</span>
<span id="cb2-28"><a href="#cb2-28" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f"Error querying inflation data: </span><span class="sc">{</span>e<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb2-29"><a href="#cb2-29" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> pd.DataFrame()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><img src="yieldsdb.png" class="img-fluid"></p>
<p>All in all, the data management architecture is relatively straightforward, with importing and handling our financial time-series data as the main goal. The database currently has three tables for yields, CPI, and VIX data but can easily be expanded to include more exogenous variables to incorporate into improving the “regime-awareness” hypothesis.</p>
</section>
<section id="complex-data-visualization-via-plotly" class="level3">
<h3 class="anchored" data-anchor-id="complex-data-visualization-via-plotly">Complex Data Visualization via Plotly</h3>
<p>The project implements sophisticated three-dimensional visualizations using Plotly, creating interactive representations of yield curve surfaces that evolve over time. The 3D visualization features both historical as well as the forecasted yields. Utilizing the 3D surface visualizations in this way, allow us to go beyond two-dimensional charts to represent the multi-dimensional nature of the yield curve.</p>
<p>The core visualization function creates a 3D surface representation where:</p>
<ul>
<li>The X-axis represents different maturities (from 1-month to 30-year)</li>
<li>The Y-axis represents time (both historical and forecasted periods)</li>
<li>The Z-axis represents yield values</li>
</ul>
<p>The visualization module <code>plotting.py</code> implements a custom 3D surface generation function that creates topographical representations of yield curves for both forecasted and historical data:</p>
<div id="01e80a25-af30-4d2e-875a-c3bfced84389" class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> generate_surface_plot(forecast_model, selected_maturities, db_file, start_date, end_date, vix_data<span class="op">=</span><span class="va">None</span>):</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""Creates a 3D surface visualization of historical and forecasted yield curves.</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="co">    </span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="co">    Purpose:</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a><span class="co">    Generates an interactive 3D surface plot showing the evolution of the yield curve</span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a><span class="co">    over time, including both historical data and forward-looking model forecasts.</span></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a><span class="co">    Selected maturities can be highlighted with individual time series lines.</span></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a><span class="co">    </span></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a><span class="co">    Args:</span></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a><span class="co">        forecast_model: Model name to use for forecasting ("Heuristic", </span></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a><span class="co">            "ImprovedHeuristic", or "RLS").</span></span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a><span class="co">        selected_maturities: List of maturities to highlight with individual lines.</span></span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a><span class="co">        db_file: Path to SQLite database with yield data.</span></span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a><span class="co">        start_date: Start date for historical data in 'YYYY-MM-DD' format.</span></span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a><span class="co">        end_date: End date for historical data in 'YYYY-MM-DD' format.</span></span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a><span class="co">        vix_data: Optional DataFrame with VIX data for forecast enhancement.</span></span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a><span class="co">        </span></span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a><span class="co">    Returns:</span></span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a><span class="co">        go.Figure: Plotly figure object containing the 3D yield curve visualization.</span></span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a><span class="co">        </span></span>
<span id="cb3-21"><a href="#cb3-21" aria-hidden="true" tabindex="-1"></a><span class="co">    Raises:</span></span>
<span id="cb3-22"><a href="#cb3-22" aria-hidden="true" tabindex="-1"></a><span class="co">        Exception: If an error occurs during plot generation.</span></span>
<span id="cb3-23"><a href="#cb3-23" aria-hidden="true" tabindex="-1"></a><span class="co">    """</span></span>
<span id="cb3-24"><a href="#cb3-24" aria-hidden="true" tabindex="-1"></a>    <span class="cf">try</span>:</span>
<span id="cb3-25"><a href="#cb3-25" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Process historical data with memory efficiency in mind</span></span>
<span id="cb3-26"><a href="#cb3-26" aria-hidden="true" tabindex="-1"></a>        historical_df <span class="op">=</span> data.prepare_data(db_file, start_date, end_date)</span>
<span id="cb3-27"><a href="#cb3-27" aria-hidden="true" tabindex="-1"></a>        historical_df.index <span class="op">=</span> pd.to_datetime(historical_df.index)</span>
<span id="cb3-28"><a href="#cb3-28" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb3-29"><a href="#cb3-29" aria-hidden="true" tabindex="-1"></a>        <span class="co"># For large datasets, subsample to improve performance while preserving trends</span></span>
<span id="cb3-30"><a href="#cb3-30" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="bu">len</span>(historical_df) <span class="op">&gt;</span> <span class="dv">200</span>:</span>
<span id="cb3-31"><a href="#cb3-31" aria-hidden="true" tabindex="-1"></a>            historical_df <span class="op">=</span> historical_df.iloc[::<span class="dv">2</span>]  <span class="co"># Take every other row</span></span>
<span id="cb3-32"><a href="#cb3-32" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb3-33"><a href="#cb3-33" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Prepare maturity data for consistent plotting</span></span>
<span id="cb3-34"><a href="#cb3-34" aria-hidden="true" tabindex="-1"></a>        available_maturities <span class="op">=</span> [<span class="bu">round</span>(<span class="bu">float</span>(col), <span class="dv">4</span>) <span class="cf">for</span> col <span class="kw">in</span> historical_df.columns]</span>
<span id="cb3-35"><a href="#cb3-35" aria-hidden="true" tabindex="-1"></a>        sorted_maturities <span class="op">=</span> <span class="bu">sorted</span>(available_maturities, reverse<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb3-36"><a href="#cb3-36" aria-hidden="true" tabindex="-1"></a>        historical_df <span class="op">=</span> historical_df.reindex(columns<span class="op">=</span>config.MATURITIES_LIST)[sorted_maturities]</span>
<span id="cb3-37"><a href="#cb3-37" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb3-38"><a href="#cb3-38" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Convert dates to numeric values for 3D plotting</span></span>
<span id="cb3-39"><a href="#cb3-39" aria-hidden="true" tabindex="-1"></a>        base_date <span class="op">=</span> historical_df.index.<span class="bu">min</span>()</span>
<span id="cb3-40"><a href="#cb3-40" aria-hidden="true" tabindex="-1"></a>        hist_dates_numeric <span class="op">=</span> (historical_df.index <span class="op">-</span> base_date).days</span>
<span id="cb3-41"><a href="#cb3-41" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb3-42"><a href="#cb3-42" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Create meshgrid for 3D surface - positions represent maturity indices</span></span>
<span id="cb3-43"><a href="#cb3-43" aria-hidden="true" tabindex="-1"></a>        positions <span class="op">=</span> np.arange(<span class="bu">len</span>(sorted_maturities))</span>
<span id="cb3-44"><a href="#cb3-44" aria-hidden="true" tabindex="-1"></a>        X_hist, Y_hist <span class="op">=</span> np.meshgrid(positions, hist_dates_numeric)</span>
<span id="cb3-45"><a href="#cb3-45" aria-hidden="true" tabindex="-1"></a>        Z_hist <span class="op">=</span> historical_df.fillna(<span class="dv">0</span>).values</span>
<span id="cb3-46"><a href="#cb3-46" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb3-47"><a href="#cb3-47" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Adapt forecast length based on visualization complexity</span></span>
<span id="cb3-48"><a href="#cb3-48" aria-hidden="true" tabindex="-1"></a>        forecast_steps <span class="op">=</span> <span class="dv">24</span>  <span class="co"># Standard value: 2-year forecast</span></span>
<span id="cb3-49"><a href="#cb3-49" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="bu">len</span>(selected_maturities) <span class="op">&gt;</span> <span class="dv">5</span>:</span>
<span id="cb3-50"><a href="#cb3-50" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Shorter forecast horizon when displaying many maturity lines</span></span>
<span id="cb3-51"><a href="#cb3-51" aria-hidden="true" tabindex="-1"></a>            forecast_steps <span class="op">=</span> <span class="dv">12</span></span>
<span id="cb3-52"><a href="#cb3-52" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb3-53"><a href="#cb3-53" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Generate forecast data using the selected model</span></span>
<span id="cb3-54"><a href="#cb3-54" aria-hidden="true" tabindex="-1"></a>        forecast_df <span class="op">=</span> models.forecast_yield_curve(</span>
<span id="cb3-55"><a href="#cb3-55" aria-hidden="true" tabindex="-1"></a>            forecast_model, db_file, start_date, end_date, </span>
<span id="cb3-56"><a href="#cb3-56" aria-hidden="true" tabindex="-1"></a>            sorted_maturities, forecast_steps<span class="op">=</span>forecast_steps, vix_data<span class="op">=</span>vix_data</span>
<span id="cb3-57"><a href="#cb3-57" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb3-58"><a href="#cb3-58" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb3-59"><a href="#cb3-59" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Prepare forecast data for 3D visualization</span></span>
<span id="cb3-60"><a href="#cb3-60" aria-hidden="true" tabindex="-1"></a>        forecast_df[<span class="st">"maturity_numeric"</span>] <span class="op">=</span> forecast_df[<span class="st">"maturity_numeric"</span>].astype(<span class="bu">float</span>)</span>
<span id="cb3-61"><a href="#cb3-61" aria-hidden="true" tabindex="-1"></a>        forecast_pivot <span class="op">=</span> forecast_df.pivot(index<span class="op">=</span><span class="st">"date"</span>, columns<span class="op">=</span><span class="st">"maturity_numeric"</span>, values<span class="op">=</span><span class="st">"yield"</span>)</span>
<span id="cb3-62"><a href="#cb3-62" aria-hidden="true" tabindex="-1"></a>        forecast_pivot <span class="op">=</span> forecast_pivot.reindex(columns<span class="op">=</span>sorted_maturities).ffill().bfill().fillna(<span class="dv">0</span>)</span>
<span id="cb3-63"><a href="#cb3-63" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb3-64"><a href="#cb3-64" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Convert forecast dates to numeric values for plotting</span></span>
<span id="cb3-65"><a href="#cb3-65" aria-hidden="true" tabindex="-1"></a>        forecast_dates_numeric <span class="op">=</span> (forecast_pivot.index <span class="op">-</span> base_date).days.values</span>
<span id="cb3-66"><a href="#cb3-66" aria-hidden="true" tabindex="-1"></a>        X_fore, Y_fore <span class="op">=</span> np.meshgrid(positions, forecast_dates_numeric)</span>
<span id="cb3-67"><a href="#cb3-67" aria-hidden="true" tabindex="-1"></a>        Z_fore <span class="op">=</span> forecast_pivot.values</span>
<span id="cb3-68"><a href="#cb3-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-69"><a href="#cb3-69" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Adapt surface opacity based on selection mode</span></span>
<span id="cb3-70"><a href="#cb3-70" aria-hidden="true" tabindex="-1"></a>        surface_opacity <span class="op">=</span> <span class="fl">0.05</span> <span class="cf">if</span> selected_maturities <span class="cf">else</span> <span class="fl">0.6</span></span>
<span id="cb3-71"><a href="#cb3-71" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-72"><a href="#cb3-72" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Create the base figure</span></span>
<span id="cb3-73"><a href="#cb3-73" aria-hidden="true" tabindex="-1"></a>        fig <span class="op">=</span> go.Figure()</span>
<span id="cb3-74"><a href="#cb3-74" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb3-75"><a href="#cb3-75" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Add historical yield curve surface (blue gradient)</span></span>
<span id="cb3-76"><a href="#cb3-76" aria-hidden="true" tabindex="-1"></a>        fig.add_trace(go.Surface(</span>
<span id="cb3-77"><a href="#cb3-77" aria-hidden="true" tabindex="-1"></a>            x<span class="op">=</span>X_hist, y<span class="op">=</span>Y_hist, z<span class="op">=</span>Z_hist,</span>
<span id="cb3-78"><a href="#cb3-78" aria-hidden="true" tabindex="-1"></a>            colorscale<span class="op">=</span><span class="st">"Blues"</span>,</span>
<span id="cb3-79"><a href="#cb3-79" aria-hidden="true" tabindex="-1"></a>            opacity<span class="op">=</span>surface_opacity,</span>
<span id="cb3-80"><a href="#cb3-80" aria-hidden="true" tabindex="-1"></a>            name<span class="op">=</span><span class="st">"Historical Yield Curve"</span>,</span>
<span id="cb3-81"><a href="#cb3-81" aria-hidden="true" tabindex="-1"></a>            showscale<span class="op">=</span><span class="va">False</span></span>
<span id="cb3-82"><a href="#cb3-82" aria-hidden="true" tabindex="-1"></a>        ))</span>
<span id="cb3-83"><a href="#cb3-83" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb3-84"><a href="#cb3-84" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Add forecast yield curve surface (orange-cyan-blue gradient)</span></span>
<span id="cb3-85"><a href="#cb3-85" aria-hidden="true" tabindex="-1"></a>        custom_scale <span class="op">=</span> [[<span class="dv">0</span>, <span class="st">'darkorange'</span>], [<span class="fl">0.5</span>, <span class="st">'cyan'</span>], [<span class="dv">1</span>, <span class="st">'darkblue'</span>]]</span>
<span id="cb3-86"><a href="#cb3-86" aria-hidden="true" tabindex="-1"></a>        fig.add_trace(go.Surface(</span>
<span id="cb3-87"><a href="#cb3-87" aria-hidden="true" tabindex="-1"></a>            x<span class="op">=</span>X_fore, y<span class="op">=</span>Y_fore, z<span class="op">=</span>Z_fore,</span>
<span id="cb3-88"><a href="#cb3-88" aria-hidden="true" tabindex="-1"></a>            colorscale<span class="op">=</span>custom_scale,</span>
<span id="cb3-89"><a href="#cb3-89" aria-hidden="true" tabindex="-1"></a>            opacity<span class="op">=</span>surface_opacity,</span>
<span id="cb3-90"><a href="#cb3-90" aria-hidden="true" tabindex="-1"></a>            name<span class="op">=</span><span class="st">"Forecast Yield Curve"</span>,</span>
<span id="cb3-91"><a href="#cb3-91" aria-hidden="true" tabindex="-1"></a>            showscale<span class="op">=</span><span class="va">False</span></span>
<span id="cb3-92"><a href="#cb3-92" aria-hidden="true" tabindex="-1"></a>        ))</span>
<span id="cb3-93"><a href="#cb3-93" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb3-94"><a href="#cb3-94" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Add individual time series lines for selected maturities</span></span>
<span id="cb3-95"><a href="#cb3-95" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> selected_maturities:</span>
<span id="cb3-96"><a href="#cb3-96" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> m <span class="kw">in</span> selected_maturities:</span>
<span id="cb3-97"><a href="#cb3-97" aria-hidden="true" tabindex="-1"></a>                m_val <span class="op">=</span> <span class="bu">round</span>(<span class="bu">float</span>(m), <span class="dv">4</span>)</span>
<span id="cb3-98"><a href="#cb3-98" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> m_val <span class="kw">not</span> <span class="kw">in</span> sorted_maturities:</span>
<span id="cb3-99"><a href="#cb3-99" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">continue</span></span>
<span id="cb3-100"><a href="#cb3-100" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb3-101"><a href="#cb3-101" aria-hidden="true" tabindex="-1"></a>                <span class="co"># Extract historical data for this maturity</span></span>
<span id="cb3-102"><a href="#cb3-102" aria-hidden="true" tabindex="-1"></a>                hist_ts <span class="op">=</span> historical_df[m_val].reset_index()</span>
<span id="cb3-103"><a href="#cb3-103" aria-hidden="true" tabindex="-1"></a>                hist_ts.rename(columns<span class="op">=</span>{m_val: <span class="st">"yield"</span>}, inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb3-104"><a href="#cb3-104" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb3-105"><a href="#cb3-105" aria-hidden="true" tabindex="-1"></a>                <span class="co"># Get forecast for this specific maturity</span></span>
<span id="cb3-106"><a href="#cb3-106" aria-hidden="true" tabindex="-1"></a>                forecast_ts <span class="op">=</span> models.forecast_individual_maturity(</span>
<span id="cb3-107"><a href="#cb3-107" aria-hidden="true" tabindex="-1"></a>                    db_file, start_date, end_date, m_val, </span>
<span id="cb3-108"><a href="#cb3-108" aria-hidden="true" tabindex="-1"></a>                    model<span class="op">=</span>forecast_model, vix_data<span class="op">=</span>vix_data</span>
<span id="cb3-109"><a href="#cb3-109" aria-hidden="true" tabindex="-1"></a>                )</span>
<span id="cb3-110"><a href="#cb3-110" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb3-111"><a href="#cb3-111" aria-hidden="true" tabindex="-1"></a>                <span class="co"># Combine historical and forecast for continuous visualization</span></span>
<span id="cb3-112"><a href="#cb3-112" aria-hidden="true" tabindex="-1"></a>                combined_ts <span class="op">=</span> pd.concat([hist_ts, forecast_ts], ignore_index<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb3-113"><a href="#cb3-113" aria-hidden="true" tabindex="-1"></a>                combined_ts.sort_values(<span class="st">"date"</span>, inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb3-114"><a href="#cb3-114" aria-hidden="true" tabindex="-1"></a>                combined_ts[<span class="st">'date_str'</span>] <span class="op">=</span> combined_ts[<span class="st">'date'</span>].dt.strftime(<span class="st">"%m-%Y"</span>)</span>
<span id="cb3-115"><a href="#cb3-115" aria-hidden="true" tabindex="-1"></a>                combined_ts[<span class="st">'date_numeric'</span>] <span class="op">=</span> (combined_ts[<span class="st">'date'</span>] <span class="op">-</span> base_date).dt.days</span>
<span id="cb3-116"><a href="#cb3-116" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb3-117"><a href="#cb3-117" aria-hidden="true" tabindex="-1"></a>                <span class="co"># Add the maturity-specific line to the 3D plot</span></span>
<span id="cb3-118"><a href="#cb3-118" aria-hidden="true" tabindex="-1"></a>                pos <span class="op">=</span> sorted_maturities.index(m_val)</span>
<span id="cb3-119"><a href="#cb3-119" aria-hidden="true" tabindex="-1"></a>                fig.add_trace(go.Scatter3d(</span>
<span id="cb3-120"><a href="#cb3-120" aria-hidden="true" tabindex="-1"></a>                    x<span class="op">=</span>[pos] <span class="op">*</span> <span class="bu">len</span>(combined_ts),  <span class="co"># Fixed x position for this maturity</span></span>
<span id="cb3-121"><a href="#cb3-121" aria-hidden="true" tabindex="-1"></a>                    y<span class="op">=</span>combined_ts[<span class="st">'date_numeric'</span>],  <span class="co"># Date position</span></span>
<span id="cb3-122"><a href="#cb3-122" aria-hidden="true" tabindex="-1"></a>                    z<span class="op">=</span>combined_ts[<span class="st">'yield'</span>],  <span class="co"># Yield values</span></span>
<span id="cb3-123"><a href="#cb3-123" aria-hidden="true" tabindex="-1"></a>                    mode<span class="op">=</span><span class="st">'lines'</span>,</span>
<span id="cb3-124"><a href="#cb3-124" aria-hidden="true" tabindex="-1"></a>                    line<span class="op">=</span><span class="bu">dict</span>(color<span class="op">=</span><span class="st">'black'</span>, width<span class="op">=</span><span class="fl">1.1</span>),</span>
<span id="cb3-125"><a href="#cb3-125" aria-hidden="true" tabindex="-1"></a>                    name<span class="op">=</span><span class="ss">f"</span><span class="sc">{</span><span class="bu">int</span>(m_val)<span class="sc">}</span><span class="ss">Y"</span> <span class="cf">if</span> m_val <span class="op">&gt;=</span> <span class="dv">1</span> <span class="cf">else</span> <span class="ss">f"</span><span class="sc">{</span><span class="bu">int</span>(<span class="bu">round</span>(m_val<span class="op">*</span><span class="dv">12</span>))<span class="sc">}</span><span class="ss">M"</span>,</span>
<span id="cb3-126"><a href="#cb3-126" aria-hidden="true" tabindex="-1"></a>                    <span class="co"># Enhanced hover information for financial analysis</span></span>
<span id="cb3-127"><a href="#cb3-127" aria-hidden="true" tabindex="-1"></a>                    hovertemplate<span class="op">=</span><span class="st">"&lt;b&gt;Maturity:&lt;/b&gt; "</span> <span class="op">+</span> <span class="ss">f"</span><span class="sc">{</span>m_val<span class="sc">}</span><span class="ss"> years"</span> <span class="op">+</span></span>
<span id="cb3-128"><a href="#cb3-128" aria-hidden="true" tabindex="-1"></a>                                <span class="st">"&lt;br&gt;&lt;b&gt;Date:&lt;/b&gt; %</span><span class="sc">{customdata[0]}</span><span class="st">"</span> <span class="op">+</span></span>
<span id="cb3-129"><a href="#cb3-129" aria-hidden="true" tabindex="-1"></a>                                <span class="st">"&lt;br&gt;&lt;b&gt;Yield:&lt;/b&gt; %</span><span class="sc">{z:.2f}</span><span class="st">%"</span>,</span>
<span id="cb3-130"><a href="#cb3-130" aria-hidden="true" tabindex="-1"></a>                    customdata<span class="op">=</span>combined_ts[[<span class="st">'date_str'</span>]].values</span>
<span id="cb3-131"><a href="#cb3-131" aria-hidden="true" tabindex="-1"></a>                ))</span>
<span id="cb3-132"><a href="#cb3-132" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb3-133"><a href="#cb3-133" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Configure time axis with year labels</span></span>
<span id="cb3-134"><a href="#cb3-134" aria-hidden="true" tabindex="-1"></a>        end_date_val <span class="op">=</span> forecast_pivot.index.<span class="bu">max</span>() <span class="cf">if</span> <span class="kw">not</span> forecast_pivot.empty <span class="cf">else</span> historical_df.index.<span class="bu">max</span>()</span>
<span id="cb3-135"><a href="#cb3-135" aria-hidden="true" tabindex="-1"></a>        year_ticks <span class="op">=</span> pd.date_range(start<span class="op">=</span>base_date, end<span class="op">=</span>end_date_val, freq<span class="op">=</span><span class="st">'YS'</span>)</span>
<span id="cb3-136"><a href="#cb3-136" aria-hidden="true" tabindex="-1"></a>        y_tick_vals <span class="op">=</span> [(date <span class="op">-</span> base_date).days <span class="cf">for</span> date <span class="kw">in</span> year_ticks]</span>
<span id="cb3-137"><a href="#cb3-137" aria-hidden="true" tabindex="-1"></a>        y_tick_text <span class="op">=</span> [date.strftime(<span class="st">"%Y"</span>) <span class="cf">for</span> date <span class="kw">in</span> year_ticks]</span>
<span id="cb3-138"><a href="#cb3-138" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb3-139"><a href="#cb3-139" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Set layout with optimized aspect ratio and clear axis labels</span></span>
<span id="cb3-140"><a href="#cb3-140" aria-hidden="true" tabindex="-1"></a>        fig.update_layout(</span>
<span id="cb3-141"><a href="#cb3-141" aria-hidden="true" tabindex="-1"></a>            scene<span class="op">=</span><span class="bu">dict</span>(</span>
<span id="cb3-142"><a href="#cb3-142" aria-hidden="true" tabindex="-1"></a>                xaxis<span class="op">=</span><span class="bu">dict</span>(</span>
<span id="cb3-143"><a href="#cb3-143" aria-hidden="true" tabindex="-1"></a>                    title<span class="op">=</span><span class="st">"Maturity"</span>,</span>
<span id="cb3-144"><a href="#cb3-144" aria-hidden="true" tabindex="-1"></a>                    tickvals<span class="op">=</span><span class="bu">list</span>(<span class="bu">range</span>(<span class="bu">len</span>(sorted_maturities))),</span>
<span id="cb3-145"><a href="#cb3-145" aria-hidden="true" tabindex="-1"></a>                    ticktext<span class="op">=</span>[<span class="ss">f"</span><span class="sc">{</span><span class="bu">int</span>(m)<span class="sc">}</span><span class="ss">Y"</span> <span class="cf">if</span> m <span class="op">&gt;=</span> <span class="dv">1</span> <span class="cf">else</span> <span class="ss">f"</span><span class="sc">{</span><span class="bu">int</span>(<span class="bu">round</span>(m<span class="op">*</span><span class="dv">12</span>))<span class="sc">}</span><span class="ss">M"</span> <span class="cf">for</span> m <span class="kw">in</span> sorted_maturities]</span>
<span id="cb3-146"><a href="#cb3-146" aria-hidden="true" tabindex="-1"></a>                ),</span>
<span id="cb3-147"><a href="#cb3-147" aria-hidden="true" tabindex="-1"></a>                yaxis<span class="op">=</span><span class="bu">dict</span>(</span>
<span id="cb3-148"><a href="#cb3-148" aria-hidden="true" tabindex="-1"></a>                    title<span class="op">=</span><span class="st">"Time"</span>,</span>
<span id="cb3-149"><a href="#cb3-149" aria-hidden="true" tabindex="-1"></a>                    tickvals<span class="op">=</span>y_tick_vals,</span>
<span id="cb3-150"><a href="#cb3-150" aria-hidden="true" tabindex="-1"></a>                    ticktext<span class="op">=</span>y_tick_text</span>
<span id="cb3-151"><a href="#cb3-151" aria-hidden="true" tabindex="-1"></a>                ),</span>
<span id="cb3-152"><a href="#cb3-152" aria-hidden="true" tabindex="-1"></a>                zaxis<span class="op">=</span><span class="bu">dict</span>(title<span class="op">=</span><span class="st">"Yield (%)"</span>),</span>
<span id="cb3-153"><a href="#cb3-153" aria-hidden="true" tabindex="-1"></a>                aspectratio<span class="op">=</span><span class="bu">dict</span>(x<span class="op">=</span><span class="dv">1</span>, y<span class="op">=</span><span class="dv">2</span>, z<span class="op">=</span><span class="fl">0.7</span>)</span>
<span id="cb3-154"><a href="#cb3-154" aria-hidden="true" tabindex="-1"></a>            ),</span>
<span id="cb3-155"><a href="#cb3-155" aria-hidden="true" tabindex="-1"></a>            title_text<span class="op">=</span><span class="ss">f"Historical &amp; Forecast Yield Curves (</span><span class="sc">{</span>forecast_model<span class="sc">}</span><span class="ss"> Model)"</span>,</span>
<span id="cb3-156"><a href="#cb3-156" aria-hidden="true" tabindex="-1"></a>            margin<span class="op">=</span><span class="bu">dict</span>(l<span class="op">=</span><span class="dv">0</span>, r<span class="op">=</span><span class="dv">0</span>, b<span class="op">=</span><span class="dv">10</span>, t<span class="op">=</span><span class="dv">30</span>),</span>
<span id="cb3-157"><a href="#cb3-157" aria-hidden="true" tabindex="-1"></a>            legend<span class="op">=</span><span class="bu">dict</span>(</span>
<span id="cb3-158"><a href="#cb3-158" aria-hidden="true" tabindex="-1"></a>                yanchor<span class="op">=</span><span class="st">"top"</span>,</span>
<span id="cb3-159"><a href="#cb3-159" aria-hidden="true" tabindex="-1"></a>                y<span class="op">=</span><span class="fl">0.99</span>,</span>
<span id="cb3-160"><a href="#cb3-160" aria-hidden="true" tabindex="-1"></a>                xanchor<span class="op">=</span><span class="st">"left"</span>,</span>
<span id="cb3-161"><a href="#cb3-161" aria-hidden="true" tabindex="-1"></a>                x<span class="op">=</span><span class="fl">0.01</span></span>
<span id="cb3-162"><a href="#cb3-162" aria-hidden="true" tabindex="-1"></a>            )</span>
<span id="cb3-163"><a href="#cb3-163" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb3-164"><a href="#cb3-164" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb3-165"><a href="#cb3-165" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Clean up large intermediate objects to free memory</span></span>
<span id="cb3-166"><a href="#cb3-166" aria-hidden="true" tabindex="-1"></a>        <span class="kw">del</span> X_hist, Y_hist, Z_hist, X_fore, Y_fore, Z_fore</span>
<span id="cb3-167"><a href="#cb3-167" aria-hidden="true" tabindex="-1"></a>        gc.collect()</span>
<span id="cb3-168"><a href="#cb3-168" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb3-169"><a href="#cb3-169" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> fig</span>
<span id="cb3-170"><a href="#cb3-170" aria-hidden="true" tabindex="-1"></a>    <span class="cf">except</span> <span class="pp">Exception</span> <span class="im">as</span> e:</span>
<span id="cb3-171"><a href="#cb3-171" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Log the error for debugging</span></span>
<span id="cb3-172"><a href="#cb3-172" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f"Error in generate_surface_plot: </span><span class="sc">{</span><span class="bu">str</span>(e)<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb3-173"><a href="#cb3-173" aria-hidden="true" tabindex="-1"></a>        <span class="cf">raise</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Some of the challenges that arose when plotting the 3D yield curve came from concatenating the historical and forecasted yield graphs. Making sure that the forecasting graph exhibited continuity (no large gap) was a reoccurring issue.</p>
<p>One of the features I wanted the 3D visualization to have was the ability for users to select a specific maturity and be able to view it without the obstruction of the entire three-dimensional plot. Thus, the rendering engine also dynamically adjusts opacity levels based on user-selected maturity, creating a focus effect where the surface becomes semi-transparent when specific yield curves are highlighted.</p>
<p>This complex visualization approach transforms numerical yield data into an intuitive visual format that makes patterns, anomalies, and trends immediately apparent (financial shocks like COVID-19 can be easily visible).</p>
<p>Beyond the 3D visualizations, the <code>plotting.py</code> module contains specialized plot functions for yield curve spreads, inversion analysis, and volatility correlations. These visualizations implement custom color-coding schemes that map domain-specific concepts like recession probabilities to visual elements that financial analysts can readily interpret. These visualizations accompany the main 3D yield curve to better understand how they work with yield curve dynamics.</p>
<p><img src="3DYieldCurve.png" class="img-fluid"></p>
</section>
<section id="mathematical-modeling" class="level3">
<h3 class="anchored" data-anchor-id="mathematical-modeling">Mathematical Modeling</h3>
<p>The core of the application lies in its mathematical modeling capabilities. The system implements multiple forecasting approaches, each with specific strengths for different market environments.</p>
<p>We’ll focus on the “Improved-Heuristic” model which utilized CPI and VIX data to create factors used in a simple decay function:</p>
<p><span class="math display">\[Y_{t+h,m} = Y_{t,m} \cdot (1-d_{m,t})^h + \alpha_{m,h} \cdot (M_{m,t} - Y_{t,m} \cdot (1-d_{m,t})^h) + \epsilon_{t,h,m}\]</span></p>
<p>Where: - <span class="math inline">\(Y_{t,m}\)</span> is the yield at time <span class="math inline">\(t\)</span> for maturity <span class="math inline">\(m\)</span> - <span class="math inline">\(h\)</span> is the forecast horizon in months - <span class="math inline">\(d_{m,t}\)</span> is the effective decay rate, varying by maturity and time - <span class="math inline">\(\alpha_{m,h}\)</span> is the horizon-dependent mean reversion strength - <span class="math inline">\(M_{m,t}\)</span> is the maturity-specific mean reversion target - <span class="math inline">\(\epsilon_{t,h,m}\)</span> is a noise term based on historical volatility</p>
<p><strong>Maturity-Specific Decay Rates</strong></p>
<p>The model implements non-linear scaling of decay rates across the curve:</p>
<p><span class="math display">\[d_{m,t} = d_{max} - (d_{max} - d_{min}) \cdot \left(\frac{m - m_{min}}{m_{max} - m_{min}}\right)^{\gamma_m} + \beta_{infl,t}\]</span></p>
<p>Where: - <span class="math inline">\(d_{max}\)</span> is the maximum decay rate (for shortest maturities) - <span class="math inline">\(d_{min}\)</span> is the minimum decay rate (for longest maturities) - <span class="math inline">\(\gamma_m\)</span> is a maturity-dependent power factor (0.7 for short maturities, 0.9 for longer ones) - <span class="math inline">\(\beta_{infl,t}\)</span> is an inflation-based adjustment</p>
<p>The model adjusts decay rates across the curve, applying faster decay for short-term rates and slower decay for long-term rates:</p>
<div id="a7134aa7-24a1-4bec-98f5-74c4f51137a0" class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute base decay rate with non-linear scaling for short-term rates</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> m <span class="op">&lt;=</span> <span class="dv">1</span>:  <span class="co"># 1 year or less - faster decay initially</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>    base_decay <span class="op">=</span> d_max <span class="op">-</span> (d_max <span class="op">-</span> d_min) <span class="op">*</span> np.power((m <span class="op">-</span> m_min) <span class="op">/</span> (m_max <span class="op">-</span> m_min), <span class="fl">0.7</span>)</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a><span class="cf">else</span>:</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>    base_decay <span class="op">=</span> d_max <span class="op">-</span> (d_max <span class="op">-</span> d_min) <span class="op">*</span> np.power((m <span class="op">-</span> m_min) <span class="op">/</span> (m_max <span class="op">-</span> m_min), <span class="fl">0.9</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><strong>Inflation and Volatility Adjustments</strong></p>
<p>The inflation adjustment term <span class="math inline">\(\beta_{infl,t}\)</span> is calculated as:</p>
<p><span class="math display">\[\beta_{infl,t} = \begin{cases}
-0.08 - 0.02 \cdot I'_t &amp; \text{if } I_t &gt; 4\% \text{ and } I'_t &gt; 0 \\
-0.05 - 0.01 \cdot I'_t &amp; \text{if } I_t &gt; 3\% \text{ and } I'_t &gt; 0 \\
-0.03 &amp; \text{if } 1\% \leq I_t &lt; 3\% \\
-0.015 &amp; \text{if } 0 \leq I_t &lt; 1\% \\
-0.005 + 0.005 \cdot |I'_t| &amp; \text{if } I_t &lt; 0\% \text{ and } I'_t &lt; 0
\end{cases}\]</span></p>
<p>Where: - <span class="math inline">\(I_t\)</span> is the current inflation rate - <span class="math inline">\(I'_t\)</span> is the inflation momentum (change over recent periods)</p>
<p>This is further adjusted by market volatility:</p>
<p><span class="math display">\[\beta_{infl,t} = \beta_{infl,t} \cdot V_f\]</span></p>
<p>Where <span class="math inline">\(V_f\)</span> is a volatility adjustment factor:</p>
<p><span class="math display">\[V_f = \begin{cases}
1.3 &amp; \text{if VIX} &gt; 30 \\
1.1 &amp; \text{if VIX} &gt; 20 \\
0.9 &amp; \text{if VIX} &lt; 15 \\
1.0 &amp; \text{otherwise}
\end{cases}\]</span></p>
<p>Here, we implement the math using simple else-if statements to refine our bias estimator:</p>
<div id="585a9494-f707-4b43-87ef-03b4d3cc8180" class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Base bias calculation with momentum factor - higher inflation = more negative bias</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> recent_inflation <span class="op">&gt;</span> <span class="dv">4</span>:  <span class="co"># Very high inflation</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>    base_bias <span class="op">=</span> <span class="op">-</span><span class="fl">0.08</span> <span class="op">-</span> (<span class="fl">0.02</span> <span class="op">*</span> inflation_trend <span class="cf">if</span> inflation_trend <span class="op">&gt;</span> <span class="dv">0</span> <span class="cf">else</span> <span class="dv">0</span>)</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="cf">elif</span> recent_inflation <span class="op">&gt;</span> <span class="dv">3</span>:  <span class="co"># High inflation</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>    base_bias <span class="op">=</span> <span class="op">-</span><span class="fl">0.05</span> <span class="op">-</span> (<span class="fl">0.01</span> <span class="op">*</span> inflation_trend <span class="cf">if</span> inflation_trend <span class="op">&gt;</span> <span class="dv">0</span> <span class="cf">else</span> <span class="dv">0</span>)</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a><span class="cf">elif</span> recent_inflation <span class="op">&gt;=</span> <span class="dv">1</span>:  <span class="co"># Normal inflation</span></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>    base_bias <span class="op">=</span> <span class="op">-</span><span class="fl">0.03</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><strong>Dynamic Mean Reversion</strong></p>
<p>The mean reversion target <span class="math inline">\(M_{m,t}\)</span> combines historical averages with economic factors:</p>
<p><span class="math display">\[M_{m,t} = w_{s,m} \cdot \mu_{s,m} + w_{m,m} \cdot \mu_{m,m} + w_{l,m} \cdot \mu_{l,m}\]</span></p>
<p>Where: - <span class="math inline">\(\mu_{s,m}\)</span>, <span class="math inline">\(\mu_{m,m}\)</span>, <span class="math inline">\(\mu_{l,m}\)</span> are short, medium, and long-term historical means - <span class="math inline">\(w_{s,m}\)</span>, <span class="math inline">\(w_{m,m}\)</span>, <span class="math inline">\(w_{l,m}\)</span> are maturity-specific weights</p>
<p>This target is then adjusted by economic factors:</p>
<p><span class="math display">\[M_{m,t} = M_{m,t} \cdot (1 + \delta_m \cdot E_t)\]</span></p>
<p>Where: - <span class="math inline">\(E_t\)</span> is a composite economic factor score - <span class="math inline">\(\delta_m\)</span> is a maturity-dependent sensitivity (ranging from 0.01 to 0.05)</p>
<p><strong>Noise Generation</strong></p>
<p>The noise term incorporates: 1. Historical volatility 2. Maturity-specific scaling 3. Time horizon effects 4. Volatility regime adjustments</p>
<p><span class="math display">\[\epsilon_{t,h,m} = \sigma_{m} \cdot e^{-0.2m} \cdot \sqrt{\min(1, \frac{h}{12})} \cdot V_f \cdot \mathcal{N}(0.002, 1)\]</span></p>
<p>Where: - <span class="math inline">\(\sigma_m\)</span> is the historical standard deviation for maturity <span class="math inline">\(m\)</span> - <span class="math inline">\(e^{-0.2m}\)</span> provides exponential decay in noise with maturity - The square root term increases noise with forecast horizon - <span class="math inline">\(V_f\)</span> is the volatility regime factor - <span class="math inline">\(\mathcal{N}(0.002, 1)\)</span> is a slightly biased normal distribution</p>
<p>This mathematical framework enables the model to adapt to changing market conditions while maintaining economically reasonable forecasts across different maturities and time horizons.</p>
<p>In addition to all this, we can classify the variables into simple regimes by incorporating the yield curve spreads (calculated by taking the difference of yields between long and short term maturities):</p>
<div id="ca56d529-0c54-494b-9d82-36f704ba3908" class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Determine curve regime based on inversion status and change direction</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> is_inverted:</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> spread_change <span class="op">&gt;</span> <span class="fl">0.05</span>:</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Inverted but steepening - often signals end of tightening</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>        regime_info[<span class="st">'curve_regime'</span>] <span class="op">=</span> <span class="st">"inverted_steepening"</span></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Strongly inverted - typical of late-cycle</span></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>        regime_info[<span class="st">'curve_regime'</span>] <span class="op">=</span> <span class="st">"inverted_flat"</span></span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a><span class="cf">else</span>:</span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> spread_change <span class="op">&gt;</span> <span class="fl">0.1</span>:</span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Rapidly steepening - often signals easing</span></span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a>        regime_info[<span class="st">'curve_regime'</span>] <span class="op">=</span> <span class="st">"steepening"</span></span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">elif</span> spread_change <span class="op">&lt;</span> <span class="op">-</span><span class="fl">0.1</span>:</span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Flattening - typical of tightening</span></span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a>        regime_info[<span class="st">'curve_regime'</span>] <span class="op">=</span> <span class="st">"flattening"</span></span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb6-17"><a href="#cb6-17" aria-hidden="true" tabindex="-1"></a>        regime_info[<span class="st">'curve_regime'</span>] <span class="op">=</span> <span class="st">"normal"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>This regime awareness allows the model to account for business cycle dynamics, adjusting forecasts based on whether the market is in a tightening cycle, easing cycle, or transitioning between regimes.</p>
<p>Thus, combining all the exogenous variables with an easier-to-work-with model (exponential decay) was the focus of research throughout the majority of this project. While results are still not on par with the widespread statistical forecasting models (AFNS), the error metric results are seemingly decent enough that further research likely could reveal a statistically significant improvement in yield curve forecasting.</p>
</section>
<section id="building-a-dynamic-dash-app" class="level3">
<h3 class="anchored" data-anchor-id="building-a-dynamic-dash-app">Building a Dynamic Dash App</h3>
<p>The Dash application integrates all the components into a cohesive, interactive user interface. It’s built using a modular architecture that separates concerns between data access, model computation, and presentation, allowing for easier maintenance and future enhancements. The application features three main tabs:</p>
<ul>
<li><strong>Visualization Tab</strong>: Interactive 3D visualization of historical and forecasted yield curves</li>
<li><strong>Backtesting Tab</strong>: Model evaluation and performance metrics across different time horizons</li>
<li><strong>Analysis Tab</strong>: Statistical analysis, spread visualization, and market regime detection</li>
</ul>
<p>The application uses a modular design pattern that separates concerns between different functional areas:</p>
<p>(Note: The code for the Dash app in <code>dashboard.py</code> is long, thus snippets will be highlighted)</p>
<div id="19dc1c08-3b69-4d59-8174-f7c2ad929f13" class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> create_app():</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""Creates and configures the Dash application for yield curve analysis."""</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Initialize Dash app with Bootstrap styling</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>    app <span class="op">=</span> Dash(<span class="va">__name__</span>, external_stylesheets<span class="op">=</span>[dbc.themes.BOOTSTRAP])</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Define the application layout with multiple tabs</span></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>    app.layout <span class="op">=</span> html.Div([</span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Navigation header</span></span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>        dbc.NavbarSimple(</span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>            brand<span class="op">=</span><span class="st">"Yield Curve Analysis &amp; Forecasting Dashboard"</span>,</span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a>            brand_href<span class="op">=</span><span class="st">"#"</span>,</span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a>            color<span class="op">=</span><span class="st">"primary"</span>,</span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a>            dark<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a>        ),</span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a>        <span class="co"># State storage components</span></span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a>        dcc.Store(<span class="bu">id</span><span class="op">=</span><span class="st">'current-model-store'</span>, data<span class="op">=</span><span class="st">'Heuristic'</span>),</span>
<span id="cb7-18"><a href="#cb7-18" aria-hidden="true" tabindex="-1"></a>        dcc.Store(<span class="bu">id</span><span class="op">=</span><span class="st">'selected-maturities-store'</span>, data<span class="op">=</span>[]),</span>
<span id="cb7-19"><a href="#cb7-19" aria-hidden="true" tabindex="-1"></a>        dcc.Store(<span class="bu">id</span><span class="op">=</span><span class="st">'backtest-state-store'</span>, data<span class="op">=</span>{}),</span>
<span id="cb7-20"><a href="#cb7-20" aria-hidden="true" tabindex="-1"></a>        dcc.Store(<span class="bu">id</span><span class="op">=</span><span class="st">'viz-needs-refresh'</span>, data<span class="op">=</span><span class="va">False</span>),</span>
<span id="cb7-21"><a href="#cb7-21" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb7-22"><a href="#cb7-22" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Main tab structure</span></span>
<span id="cb7-23"><a href="#cb7-23" aria-hidden="true" tabindex="-1"></a>        dbc.Tabs([</span>
<span id="cb7-24"><a href="#cb7-24" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Tab 1: 3D Visualization</span></span>
<span id="cb7-25"><a href="#cb7-25" aria-hidden="true" tabindex="-1"></a>            dbc.Tab(label<span class="op">=</span><span class="st">"Yield Curve Visualization"</span>, tab_id<span class="op">=</span><span class="st">"tab-visualization"</span>, children<span class="op">=</span>[...]),</span>
<span id="cb7-26"><a href="#cb7-26" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Tab 2: Backtesting</span></span>
<span id="cb7-27"><a href="#cb7-27" aria-hidden="true" tabindex="-1"></a>            dbc.Tab(label<span class="op">=</span><span class="st">"Backtesting &amp; Evaluation"</span>, tab_id<span class="op">=</span><span class="st">"tab-backtest"</span>, children<span class="op">=</span>[...]),</span>
<span id="cb7-28"><a href="#cb7-28" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Tab 3: Analysis</span></span>
<span id="cb7-29"><a href="#cb7-29" aria-hidden="true" tabindex="-1"></a>            dbc.Tab(label<span class="op">=</span><span class="st">"Statistics &amp; Analysis"</span>, tab_id<span class="op">=</span><span class="st">"tab-analysis"</span>, children<span class="op">=</span>[...])</span>
<span id="cb7-30"><a href="#cb7-30" aria-hidden="true" tabindex="-1"></a>        ], <span class="bu">id</span><span class="op">=</span><span class="st">"main-tabs"</span>)</span>
<span id="cb7-31"><a href="#cb7-31" aria-hidden="true" tabindex="-1"></a>    ])</span>
<span id="cb7-32"><a href="#cb7-32" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb7-33"><a href="#cb7-33" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Further code</span></span>
<span id="cb7-34"><a href="#cb7-34" aria-hidden="true" tabindex="-1"></a>    <span class="co"># ...</span></span>
<span id="cb7-35"><a href="#cb7-35" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb7-36"><a href="#cb7-36" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> app</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The layout structure follows a hierarchical organization with tabs, rows, columns, and individual components, all styled with Bootstrap for a professional appearance.</p>
<p>One of the most important aspects of the Dash app is how it manages state between user interactions:</p>
<div id="9ed66066-8d4e-41cf-89a5-d05fd03128d8" class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># State storage components</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>dcc.Store(<span class="bu">id</span><span class="op">=</span><span class="st">'current-model-store'</span>, data<span class="op">=</span><span class="st">'Heuristic'</span>),</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>dcc.Store(<span class="bu">id</span><span class="op">=</span><span class="st">'selected-maturities-store'</span>, data<span class="op">=</span>[]),</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>dcc.Store(<span class="bu">id</span><span class="op">=</span><span class="st">'backtest-state-store'</span>, data<span class="op">=</span>{}),</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>dcc.Store(<span class="bu">id</span><span class="op">=</span><span class="st">'viz-needs-refresh'</span>, data<span class="op">=</span><span class="va">False</span>),</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>These <code>dcc.Store</code> components serve as client-side state containers that persist between callback executions. This approach:</p>
<ul>
<li>Reduces redundant computations by storing user selections and current state</li>
<li>Prevents unnecessary re-rendering of complex visualizations</li>
<li>Enables communication between different parts of the application</li>
</ul>
<p>For instance, when a user runs a backtest, the application stores the results in <code>backtest-state-store</code> and sets <code>viz-needs-refresh</code> to <code>True</code>, which triggers a refresh of the visualization when the user returns to that tab.</p>
<p>This was implemented in order to prevent issues with backtests potentially interfering with the 3D visualization.</p>
<p>The application uses a sophisticated callback system to handle user interactions. We’ll look at one of the key callbacks used to change visualizations based on user-selected forecasting models:</p>
<div id="07a9795c-6c39-4167-9cc3-34d6eed116e1" class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="at">@app.callback</span>(</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>    [Output(<span class="st">"yield-curve-graph"</span>, <span class="st">"figure"</span>),</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>     Output(<span class="st">"current-model-store"</span>, <span class="st">"data"</span>),</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>     Output(<span class="st">"selected-maturities-store"</span>, <span class="st">"data"</span>)],</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>    [Input(<span class="st">"forecast-model-dropdown"</span>, <span class="st">"value"</span>),</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>     Input(<span class="st">"maturities-dropdown"</span>, <span class="st">"value"</span>)],</span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>    [State(<span class="st">"current-model-store"</span>, <span class="st">"data"</span>),</span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>     State(<span class="st">"selected-maturities-store"</span>, <span class="st">"data"</span>)],</span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>    prevent_initial_call<span class="op">=</span><span class="va">False</span></span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> update_figure(forecast_model, selected_maturities, current_model, stored_maturities):</span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""Updates the 3D yield curve visualization based on user selections."""</span></span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Use fallback values if inputs are empty/None</span></span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> forecast_model <span class="kw">is</span> <span class="va">None</span> <span class="kw">or</span> forecast_model <span class="op">==</span> <span class="st">""</span>:</span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a>        forecast_model <span class="op">=</span> current_model <span class="kw">or</span> <span class="st">"Heuristic"</span></span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb9-17"><a href="#cb9-17" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> selected_maturities <span class="kw">is</span> <span class="va">None</span>:</span>
<span id="cb9-18"><a href="#cb9-18" aria-hidden="true" tabindex="-1"></a>        selected_maturities <span class="op">=</span> stored_maturities <span class="kw">or</span> []</span>
<span id="cb9-19"><a href="#cb9-19" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb9-20"><a href="#cb9-20" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Generate the 3D visualization with error handling</span></span>
<span id="cb9-21"><a href="#cb9-21" aria-hidden="true" tabindex="-1"></a>    <span class="cf">try</span>:</span>
<span id="cb9-22"><a href="#cb9-22" aria-hidden="true" tabindex="-1"></a>        fig <span class="op">=</span> plotting.generate_surface_plot(</span>
<span id="cb9-23"><a href="#cb9-23" aria-hidden="true" tabindex="-1"></a>            forecast_model, </span>
<span id="cb9-24"><a href="#cb9-24" aria-hidden="true" tabindex="-1"></a>            selected_maturities, </span>
<span id="cb9-25"><a href="#cb9-25" aria-hidden="true" tabindex="-1"></a>            config.DB_FILE, </span>
<span id="cb9-26"><a href="#cb9-26" aria-hidden="true" tabindex="-1"></a>            config.DEFAULT_START_DATE, </span>
<span id="cb9-27"><a href="#cb9-27" aria-hidden="true" tabindex="-1"></a>            config.DEFAULT_END_DATE, </span>
<span id="cb9-28"><a href="#cb9-28" aria-hidden="true" tabindex="-1"></a>            vix_data</span>
<span id="cb9-29"><a href="#cb9-29" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb9-30"><a href="#cb9-30" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> fig, forecast_model, selected_maturities</span>
<span id="cb9-31"><a href="#cb9-31" aria-hidden="true" tabindex="-1"></a>    <span class="cf">except</span> <span class="pp">Exception</span> <span class="im">as</span> e:</span>
<span id="cb9-32"><a href="#cb9-32" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Create error message figure</span></span>
<span id="cb9-33"><a href="#cb9-33" aria-hidden="true" tabindex="-1"></a>        fig <span class="op">=</span> go.Figure()</span>
<span id="cb9-34"><a href="#cb9-34" aria-hidden="true" tabindex="-1"></a>        fig.add_annotation(text<span class="op">=</span><span class="ss">f"Error: </span><span class="sc">{</span><span class="bu">str</span>(e)<span class="sc">}</span><span class="ss">"</span>, </span>
<span id="cb9-35"><a href="#cb9-35" aria-hidden="true" tabindex="-1"></a>                          xref<span class="op">=</span><span class="st">"paper"</span>, yref<span class="op">=</span><span class="st">"paper"</span>, </span>
<span id="cb9-36"><a href="#cb9-36" aria-hidden="true" tabindex="-1"></a>                          x<span class="op">=</span><span class="fl">0.5</span>, y<span class="op">=</span><span class="fl">0.5</span>, showarrow<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb9-37"><a href="#cb9-37" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> fig, forecast_model, selected_maturities</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>This callback demonstrates several important principles:</p>
<ul>
<li><strong>Multiple outputs</strong>: The callback updates both the visualization and store components in a single operation</li>
<li><strong>State usage</strong>: It uses current state values as fallbacks, ensuring the application behaves predictably</li>
<li><strong>Error handling</strong>: The callback catches exceptions and provides user-friendly error messages</li>
<li><strong>Parameter delegation</strong>: The actual visualization work is delegated to the plotting module</li>
</ul>
<p><img src="dashapp.png" class="img-fluid"></p>
<p>This interactive application makes complex yield curve analysis accessible and intuitive, allowing users to quickly switch between different views, models, and analytical tools without requiring deep technical knowledge of the underlying implementation details.</p>
</section>
</section>
<section id="conclusion-and-ethical-considerations" class="level2">
<h2 class="anchored" data-anchor-id="conclusion-and-ethical-considerations">Conclusion and Ethical Considerations</h2>
<p>The Yield Curve Forecasting tool provides a comprehensive platform for fixed income analysis, combining sophisticated mathematical modeling with interactive visualizations. The system’s ability to incorporate market regimes, inflation data, and volatility metrics produces forecasts that adapt to changing economic conditions. The backtesting framework provides transparency about model performance, allowing users to make informed decisions based on historical accuracy.</p>
<section id="ethics" class="level3">
<h3 class="anchored" data-anchor-id="ethics">Ethics</h3>
<p>While the tool provides valuable insights for users ranging from intermediate investors to fixed income analysts, several ethical considerations are important to acknowledge:</p>
<ul>
<li><strong>Model Transparency</strong>: The application makes clear that all forecasts are probabilistic in nature and subject to uncertainty. The backtesting framework helps users understand the limitations of each model, preventing overconfidence in predictions.</li>
<li><strong>Financial Access Implications</strong>: Tools that enhance fixed income analysis primarily benefit institutional investors and may widen the knowledge gap between professional and retail investors. This raises questions about equitable access to financial technology.</li>
<li><strong>Market Impact</strong>: If widely adopted, model-based forecasting tools could potentially contribute to herding behavior in markets if many participants use similar models or strategies. The application’s multiple models with different approaches help mitigate this risk.</li>
<li><strong>Data Privacy</strong>: While the application uses public data, expansion to include proprietary or alternative data sources would require careful consideration of data privacy and usage rights.</li>
<li><strong>Regulatory Compliance</strong>: Users must ensure that any investment decisions made using the tool comply with relevant regulations, particularly regarding model validation requirements for financial institutions.</li>
</ul>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->




</body></html>